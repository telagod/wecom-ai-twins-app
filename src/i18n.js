const langs = {
  zh: {
    // Setup
    'setup.title.desktop': '快速部署 OpenClaw',
    'setup.title.mobile': '连接 OpenClaw',
    'setup.sub.desktop': '一键安装，本地运行',
    'setup.sub.mobile': '连接远程 Gateway',
    'setup.step.detect': '环境检测',
    'setup.step.install': '安装 OpenClaw',
    'setup.step.provider': '配置 Provider',
    'setup.step.gateway': '启动 Gateway',
    'setup.step.connect': '连接 Gateway',
    'setup.step.done': '完成',
    'setup.prev': '上一步',
    'setup.next': '下一步',
    'setup.enter': '进入仪表盘',
    'setup.detect.title': '环境检测',
    'setup.detect.node': 'Node.js 运行时',
    'setup.detect.nodeHint': 'Gateway 官方推荐 Node.js (>=22) 运行时，Bun 仅兼容兜底。',
    'setup.detect.needNode': '请先安装 Node.js 22+',
    'setup.detect.nodeMissing': '未找到 — 请安装 Node.js 22+（官方推荐）',
    'setup.detect.npmMissing': '已找到 Node.js，但缺少 npm，请修复 Node 环境',
    'setup.detect.bun': 'Bun 运行时',
    'setup.detect.bunOptional': 'Bun（可选）',
    'setup.detect.bunMissing': '未安装 — 可选，不影响 Node 方案',
    'setup.detect.openclaw': 'OpenClaw',
    'setup.detect.openclawViaBun': '{0}（via bun，非推荐）',
    'setup.detect.checking': '检测中...',
    'setup.detect.notfound': '未找到',
    'setup.detect.installBun': '安装 Bun',
    'setup.detect.notInstalled': '未安装 — 下一步将自动安装',
    'setup.install.title': '安装 OpenClaw',
    'setup.install.start': '开始安装',
    'setup.install.installing': '安装中...',
    'setup.install.retry': '重试安装',
    'setup.install.done': '已安装',
    'setup.install.nodeFirst': '将使用 npm 安装 OpenClaw（Node-first，官方推荐）。',
    'setup.install.success': '安装完成',
    'setup.install.fail': '安装失败',
    'setup.provider.title': '配置 LLM Provider',
    'setup.provider.desc': '选择 AI 模型提供商并填入 API Key。',
    'setup.provider.save': '保存配置',
    'setup.provider.skip': '跳过（已配置）',
    'setup.provider.saving': '保存中...',
    'setup.provider.saved': '✅ 已保存',
    'setup.provider.fail': '配置失败',
    'setup.provider.needKey': '请输入 API Key',
    'setup.gateway.title': '启动 Gateway',
    'setup.gateway.desc': '在本地启动 OpenClaw Gateway，应用将自动连接。',
    'setup.gateway.start': '启动 Gateway',
    'setup.gateway.skip': '已有 Gateway，跳过',
    'setup.gateway.starting': '启动中...',
    'setup.gateway.retry': '重试启动',
    'setup.gateway.started': '✅ 已启动',
    'setup.gateway.exited': 'Gateway 已退出',
    'setup.mobile.title': '连接 Gateway',
    'setup.mobile.desc': '输入远程 Gateway 地址和 Token，或扫描二维码连接。',
    'setup.mobile.url': 'Gateway 地址',
    'setup.mobile.token': 'Auth Token',
    'setup.mobile.test': '测试连接',
    'setup.mobile.probe': '局域网探测',
    'setup.mobile.probing': '探测中...',
    'setup.mobile.notfound': '未发现 Gateway',
    'setup.mobile.connecting': '连接中...',
    'setup.mobile.connected': '✅ 连接成功',
    'setup.mobile.fail': '连接失败 — 请检查地址和网络',
    'setup.done.desktop': '部署完成',
    'setup.done.mobile': '连接完成',
    'setup.done.msg.desktop': 'OpenClaw Gateway 已在本地运行',
    'setup.done.msg.mobile': 'Gateway 已连接',
    'setup.done.enter': '点击「进入仪表盘」开始使用',
    // Dashboard
    'dash.title': '仪表盘',
    'dash.sub': 'OpenClaw Gateway 概览',
    'dash.gateway': 'Gateway',
    'dash.running': '运行中',
    'dash.disconnected': '未连接',
    'dash.sessions': '会话统计',
    'dash.activeSessions': '活跃会话',
    'dash.tokens': '累计 {0} tokens',
    'dash.agents': 'Agents',
    'dash.models': '模型',
    'dash.channels': '渠道',
    'dash.noChannels': '无渠道',
    'dash.recentSessions': '最近会话',
    'dash.noSessions': '暂无会话',
    'dash.refresh': '刷新',
    'dash.connect': '连接',
    'dash.disconnect': '断开',
    'dash.uptime': '运行 {0}',
    'dash.more': '+{0} 更多',
    'dash.cron': 'Cron',
    'dash.jobs': '计划任务',
    'dash.noCron': '无计划任务',
    'dash.justNow': '刚刚',
    'dash.minAgo': '{0}分钟前',
    'dash.hourAgo': '{0}小时前',
    'dash.dayAgo': '{0}天前',
    'dash.active': '活跃',
    // Chat
    'chat.sessions': '会话',
    'chat.select': '选择会话',
    'chat.none': '暂无',
    'chat.input': '输入消息...',
    'chat.send': '发送',
    'chat.abort': '中止回复',
    'chat.reset': '重置会话',
    'chat.resetDone': '会话已重置',
    'chat.newSession': '新会话',
    'chat.newSessionDone': '已切换为新会话',
    'chat.status': '状态',
    'chat.statusLine': 'Gateway v{0} · 运行 {1}s',
    'chat.compact': '压缩',
    'chat.delete': '删除会话',
    'chat.compacted': '会话已压缩',
    'chat.deleted': '会话已删除',
    'chat.deleteConfirm': '确认删除会话 {0} 吗？',
    // Agents
    'agents.title': 'Agents',
    'agents.sub': '管理 AI Agent 实例',
    'agents.list': 'Agent 列表',
    'agents.refresh': '刷新',
    'agents.none': '暂无 Agent',
    'agents.detail': '选择一个 Agent 查看详情',
    'agents.default': '默认',
    'agents.copy': '副本',
    'agents.name': '名称',
    'agents.model': '模型',
    'agents.workspace': 'Workspace',
    'agents.files': 'Workspace 文件',
    'agents.noFiles': '无文件',
    'agents.loadFail': '加载失败',
    'agents.save': '保存',
    'agents.saved': '已保存 ✓',
    'agents.inheritModel': '继承默认',
    'agents.create': '新建',
    'agents.update': '更新',
    'agents.delete': '删除',
    'agents.createPrompt': '输入新 Agent JSON',
    'agents.created': 'Agent 已创建',
    'agents.updated': 'Agent 已更新',
    'agents.deleted': 'Agent 已删除',
    'agents.createFail': '创建失败',
    'agents.updateFail': '更新失败',
    'agents.deleteFail': '删除失败',
    'agents.deleteConfirm': '确认删除 Agent {0} 吗？',
    // Settings
    'settings.title': '设置',
    'settings.sub': 'Gateway 连接与配置管理',
    'settings.gateway': 'Gateway',
    'settings.models': '模型',
    'settings.config': '配置',
    'settings.advanced': '高级',
    'settings.url': 'Gateway URL',
    'settings.token': 'Auth Token',
    'settings.saveReconnect': '保存并重连',
    'settings.availModels': '可用模型',
    'settings.refreshModels': '刷新模型列表',
    'settings.connectFirst': '连接 Gateway 后显示',
    'settings.loadConfig': '加载配置',
    'settings.saveConfig': '保存到 Gateway',
    'settings.localSettings': '本地客户端设置（localStorage）',
    'settings.save': '保存',
    'settings.saved': '已保存',
    'settings.jsonError': 'JSON 格式错误',
    'settings.saveFail': '保存失败',
    // Common
    'common.online': '在线',
    'common.offline': '离线',
    'common.loading': '加载中...',
    'common.connected': '已连接',
    'common.notConnected': '未连接',
    'settings.checkUpdate': '检查更新',
    'settings.updateTo': '更新到',
    'settings.upToDate': '已是最新',
    'settings.newVersion': '发现新版本',
    'settings.loadFail': '加载失败',
    'settings.lang': '语言',
    'settings.langAuto': '跟随系统',
  },
  en: {
    'setup.title.desktop': 'Deploy OpenClaw',
    'setup.title.mobile': 'Connect to OpenClaw',
    'setup.sub.desktop': 'One-click install, run locally',
    'setup.sub.mobile': 'Connect to remote Gateway',
    'setup.step.detect': 'Environment',
    'setup.step.install': 'Install',
    'setup.step.provider': 'Provider',
    'setup.step.gateway': 'Gateway',
    'setup.step.connect': 'Connect',
    'setup.step.done': 'Done',
    'setup.prev': 'Back',
    'setup.next': 'Next',
    'setup.enter': 'Go to Dashboard',
    'setup.detect.title': 'Environment Check',
    'setup.detect.node': 'Node.js Runtime',
    'setup.detect.nodeHint': 'OpenClaw Gateway officially recommends Node.js (>=22). Bun is fallback only.',
    'setup.detect.needNode': 'Install Node.js 22+ first',
    'setup.detect.nodeMissing': 'Not found — install Node.js 22+ (recommended)',
    'setup.detect.npmMissing': 'Node.js found but npm is missing; fix your Node runtime',
    'setup.detect.bun': 'Bun Runtime',
    'setup.detect.bunOptional': 'Bun (optional)',
    'setup.detect.bunMissing': 'Not installed — optional for Node-first flow',
    'setup.detect.openclaw': 'OpenClaw',
    'setup.detect.openclawViaBun': '{0} (via bun, not recommended)',
    'setup.detect.checking': 'Checking...',
    'setup.detect.notfound': 'Not found',
    'setup.detect.installBun': 'Install Bun',
    'setup.detect.notInstalled': 'Not installed — will install next',
    'setup.install.title': 'Install OpenClaw',
    'setup.install.start': 'Install',
    'setup.install.installing': 'Installing...',
    'setup.install.retry': 'Retry',
    'setup.install.done': 'Installed',
    'setup.install.nodeFirst': 'OpenClaw will be installed via npm (Node-first, recommended).',
    'setup.install.success': 'Installation complete',
    'setup.install.fail': 'Installation failed',
    'setup.provider.title': 'Configure LLM Provider',
    'setup.provider.desc': 'Select an AI provider and enter your API key.',
    'setup.provider.save': 'Save',
    'setup.provider.skip': 'Skip (already configured)',
    'setup.provider.saving': 'Saving...',
    'setup.provider.saved': '✅ Saved',
    'setup.provider.fail': 'Configuration failed',
    'setup.provider.needKey': 'Please enter an API key',
    'setup.gateway.title': 'Start Gateway',
    'setup.gateway.desc': 'Start OpenClaw Gateway locally. The app will auto-connect.',
    'setup.gateway.start': 'Start Gateway',
    'setup.gateway.skip': 'Already running, skip',
    'setup.gateway.starting': 'Starting...',
    'setup.gateway.retry': 'Retry',
    'setup.gateway.started': '✅ Started',
    'setup.gateway.exited': 'Gateway exited',
    'setup.mobile.title': 'Connect to Gateway',
    'setup.mobile.desc': 'Enter the remote Gateway address and token, or scan a QR code.',
    'setup.mobile.url': 'Gateway URL',
    'setup.mobile.token': 'Auth Token',
    'setup.mobile.test': 'Test Connection',
    'setup.mobile.probe': 'Scan LAN',
    'setup.mobile.probing': 'Scanning...',
    'setup.mobile.notfound': 'No Gateway found',
    'setup.mobile.connecting': 'Connecting...',
    'setup.mobile.connected': '✅ Connected',
    'setup.mobile.fail': 'Connection failed — check address and network',
    'setup.done.desktop': 'Deployment Complete',
    'setup.done.mobile': 'Connected',
    'setup.done.msg.desktop': 'OpenClaw Gateway is running locally',
    'setup.done.msg.mobile': 'Gateway connected',
    'setup.done.enter': 'Click "Go to Dashboard" to start',
    'dash.title': 'Dashboard',
    'dash.sub': 'OpenClaw Gateway Overview',
    'dash.gateway': 'Gateway',
    'dash.running': 'Running',
    'dash.disconnected': 'Disconnected',
    'dash.sessions': 'Sessions',
    'dash.activeSessions': 'Active sessions',
    'dash.tokens': '{0} tokens total',
    'dash.agents': 'Agents',
    'dash.models': 'Models',
    'dash.channels': 'Channels',
    'dash.noChannels': 'No channels',
    'dash.recentSessions': 'Recent Sessions',
    'dash.noSessions': 'No sessions',
    'dash.refresh': 'Refresh',
    'dash.connect': 'Connect',
    'dash.disconnect': 'Disconnect',
    'dash.uptime': 'up {0}',
    'dash.more': '+{0} more',
    'dash.cron': 'Cron',
    'dash.jobs': 'Scheduled jobs',
    'dash.noCron': 'No cron jobs',
    'dash.justNow': 'just now',
    'dash.minAgo': '{0}m ago',
    'dash.hourAgo': '{0}h ago',
    'dash.dayAgo': '{0}d ago',
    'dash.active': 'Active',
    'chat.sessions': 'Sessions',
    'chat.select': 'Select session',
    'chat.none': 'None',
    'chat.input': 'Type a message...',
    'chat.send': 'Send',
    'chat.abort': 'Abort',
    'chat.reset': 'Reset session',
    'chat.resetDone': 'Session reset',
    'chat.newSession': 'New',
    'chat.newSessionDone': 'Switched to a new session',
    'chat.status': 'Status',
    'chat.statusLine': 'Gateway v{0} · uptime {1}s',
    'chat.compact': 'Compact',
    'chat.delete': 'Delete session',
    'chat.compacted': 'Session compacted',
    'chat.deleted': 'Session deleted',
    'chat.deleteConfirm': 'Delete session {0}?',
    'agents.title': 'Agents',
    'agents.sub': 'Manage AI Agent instances',
    'agents.list': 'Agent List',
    'agents.refresh': 'Refresh',
    'agents.none': 'No agents',
    'agents.detail': 'Select an agent to view details',
    'agents.default': 'Default',
    'agents.copy': 'Copy',
    'agents.name': 'Name',
    'agents.model': 'Model',
    'agents.workspace': 'Workspace',
    'agents.files': 'Workspace Files',
    'agents.noFiles': 'No files',
    'agents.loadFail': 'Load failed',
    'agents.save': 'Save',
    'agents.saved': 'Saved ✓',
    'agents.inheritModel': 'Inherit default',
    'agents.create': 'Create',
    'agents.update': 'Update',
    'agents.delete': 'Delete',
    'agents.createPrompt': 'Enter new Agent JSON',
    'agents.created': 'Agent created',
    'agents.updated': 'Agent updated',
    'agents.deleted': 'Agent deleted',
    'agents.createFail': 'Create failed',
    'agents.updateFail': 'Update failed',
    'agents.deleteFail': 'Delete failed',
    'agents.deleteConfirm': 'Delete agent {0}?',
    'settings.title': 'Settings',
    'settings.sub': 'Gateway connection & configuration',
    'settings.gateway': 'Gateway',
    'settings.models': 'Models',
    'settings.config': 'Config',
    'settings.advanced': 'Advanced',
    'settings.url': 'Gateway URL',
    'settings.token': 'Auth Token',
    'settings.saveReconnect': 'Save & Reconnect',
    'settings.availModels': 'Available Models',
    'settings.refreshModels': 'Refresh Models',
    'settings.connectFirst': 'Connect to Gateway first',
    'settings.loadConfig': 'Load Config',
    'settings.saveConfig': 'Save to Gateway',
    'settings.localSettings': 'Local client settings (localStorage)',
    'settings.save': 'Save',
    'settings.saved': 'Saved',
    'settings.jsonError': 'Invalid JSON',
    'settings.saveFail': 'Save failed',
    'common.online': 'Online',
    'common.offline': 'Offline',
    'common.loading': 'Loading...',
    'common.connected': 'Connected',
    'common.notConnected': 'Not connected',
    'settings.checkUpdate': 'Check for updates',
    'settings.updateTo': 'Update to',
    'settings.upToDate': 'Up to date',
    'settings.newVersion': 'New version',
    'settings.loadFail': 'Load failed',
    'settings.lang': 'Language',
    'settings.langAuto': 'System default',
  }
};

let currentLang = 'zh';

export function setLang(lang) { currentLang = langs[lang] ? lang : 'zh'; }
export function getLang() { return currentLang; }

export function t(key, ...args) {
  let s = langs[currentLang]?.[key] || langs.zh[key] || key;
  args.forEach((v, i) => { s = s.replace(`{${i}}`, v); });
  return s;
}

// Auto-detect language, respect saved preference
const saved = localStorage.getItem('openclaw-lang');
const nav = navigator.language || 'zh';
if (saved && saved !== 'auto') setLang(saved);
else setLang(nav.startsWith('zh') ? 'zh' : 'en');
